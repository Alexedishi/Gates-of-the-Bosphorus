## GENERAL VALUES ##
balkfm_construction_progress_value = {
	value = 0
	if = {
		limit = {
			NOR = {
				has_modifier = modifier_balkfm_construction_1
				has_modifier = modifier_balkfm_construction_2
				has_modifier = modifier_balkfm_construction_3
			}
		}
		add = 1
	}
	if = {
		limit = {
			has_modifier = modifier_balkfm_construction_1
		}
		add = 5
	}
	if = {
		limit = {
			has_modifier = modifier_balkfm_construction_2
		}
		add = 10
	}
	if = {
		limit = {
			has_modifier = modifier_balkfm_construction_3
		}
		add = 15
	}
}

balkfm_construction_points_value = { # Ripped from LRoAI
    value = 0
	add = modifier:country_construction_add
    min = 10
}

## MONTENEGRO VALUES ##

balkfm_mon_border_progress_value = {
	value = 0
	
	c:MON = { # We scope to Mon so this can get saved to a local value
		# Sources
		add = {
			desc = balkfm_value_from_bishopric_journals
			value = {
				if = {
					limit = {
						has_variable = balkfm_mon_soc_completed
					}
					add = 1
				}
				if = {
					limit = {
						has_variable = balkfm_mon_gov_completed
					}
					add = 1
				}
				if = {
					limit = {
						has_variable = balkfm_mon_mil_completed
					}
					add = 1
				}
			}
		}
		add = {
			desc = balkfm_value_from_capital_infrastructure
			value = {
				add = root.capital.relative_infrastructure
				divide = 10
				max = 10 # to prevent abuse
			}
		}
		add = {
			desc = balkfm_value_from_standing_army
			value = {
				add = root.army_power_projection
				divide = 10
				max = 100 # lol
			}
		}
		if = {
			limit = {
				has_modifier = modifier_balkfm_ransomed_noble
			}
			add = {
				desc = balkfm_value_from_ransoming_nobles
				value = 1
			}
		}
		if = {
			limit = {
				has_modifier = modifier_balkfm_executed_noble
			}
			add = {
				desc = balkfm_value_from_beheading_noble
				value = 2
			}
		}
		if = {
			limit = {
				has_modifier = modifier_balkfm_skulduggery
			}
			add = {
				desc = balkfm_value_from_skulduggery
				value = 1
			}
		}
		if = {
			limit = {
				any_country = {
					OR = {
						has_diplomatic_pact = {
							who = root
							type = alliance
						}
						has_diplomatic_pact = {
							who = root
							type = defensive_pact
						}
					}
					has_diplomatic_pact = {
						who = c:TUR
						type = rivalry
					}
				}
			}
			add = {
				desc = balkfm_value_from_diplomatic_pacts
				value = 5
			}
		}
		if = {
			limit = {
				is_in_power_bloc = yes
				power_bloc = {
					power_bloc_leader = {
						has_diplomatic_pact = {
							who = c:TUR
							type = rivalry
						}
					}
				}
			}
			add = {
				desc = balkfm_value_from_power_bloc
				value = 5
			}
		}
		
		#Penalities
		if = {
			limit = {
				has_modifier = modifier_balkfm_tolerated_abuses
			}
			subtract = {
				desc = balkfm_value_from_tolerating_abuses
				value = 1
			}
		}
		if = {
			limit = {
				has_modifier = modifier_balkfm_display_of_poverty
			}
			subtract = {
				desc = balkfm_value_from_poverty_display
				value = 1
			}
		}
		if = {
			limit = {
				has_modifier = modifier_balkfm_annexed_tribe
			}
			subtract = {
				desc = balkfm_value_from_recent_annexation
				value = 2
			}
		}
	}
}

balkfm_tur_border_progress_value = {
	value = 0
	
	c:TUR = { # We scope to TUR so this can get saved to a local value
		#Sources
		if = {
			limit = {
				NOT = {
					has_journal_entry = je_sick_man_main
				}
			}
			add = {
				desc = balkfm_value_from_sick_man
				value = 4
			}
		}
		if = {
			limit = {
				has_variable = sick_man_var
			}
			add = {
				desc = balkfm_value_from_tanzimat_progress
				value = var:sick_man_var
			}
		}
		if = {
			limit = {
				has_modifier = modifier_balkfm_providing_aid
			}
			add = {
				desc = balkfm_value_from_aid
				value = 3
			}
		}

		#Penalities
		if = {
			limit = {
				has_journal_entry = je_sick_man_main
			}
			subtract = {
				desc = balkfm_value_from_sick_man
				value = 4
			}
		}
		if = {
			limit = {
				has_modifier = modifier_balkfm_accepted_ransom
			}
			subtract = {
				desc = balkfm_value_from_ransoming_nobles
				value = 1
			}
		}
		if = {
			limit = {
				has_modifier = modifier_balkfm_annexed_tribe
			}
			subtract = {
				desc = balkfm_value_from_recent_annexation
				value = 2
			}
		}
	}
}

balkfm_total_border_progress_value = {
	value = 0
	add = balkfm_mon_border_progress_value
	subtract = balkfm_tur_border_progress_value
}

balkfm_border_control_value = {
	value = 0
	if = {
		limit = {
			p:x8C6292 = {
				owner = root
			}
		}
		add = {
			desc = balkfm_mon_value_from_cetinje
			value = 1
		}
	}
	if = {
		limit = {
			p:xF5F6C2 = {
				owner = root
			}
		}
		add = {
			desc = balkfm_mon_value_from_niksic
			value = 1
		}
	}
	if = {
		limit = {
			p:x446E84 = {
				owner = root
			}
		}
		add = {
			desc = balkfm_mon_value_from_podgorica
			value = 1
		}
	}
	if = {
		limit = {
			p:xA12F82 = {
				owner = root
			}
		}
		add = {
			desc = balkfm_mon_value_from_pljevlja
			value = 1
		}
	}
	if = {
		limit = {
			p:x90A0E0 = {
				owner = root
			}
		}
		add = {
			desc = balkfm_mon_value_from_kotor
			value = 1
		}
	}
}

balkfm_mon_captured_nobles_value = {
	value = 0
	every_character_in_void = {
		limit = {
			OR = {
				has_template = template_balkfm_captive_bosnian
				has_template = template_balkfm_captive_albanian
				has_template = template_balkfm_captive_serbian
			}
		}
		add = 1
	}
}

## SERBIA VALUES ###
obrenovic_power_value = {
	value = 0
	if = {
		limit = {
			has_law = law_type:law_autocracy
			has_law = law_type:law_single_party_state
		}
		add = 2
	}
	else_if = {
		limit = {
			OR = {
				has_law = law_type:law_oligarchy
				has_law = law_type:law_technocracy
			}
		}
		add = 1
	}
	else = {
		subtract = 3 # because the obrenovics were famously autocractic
	}
}

obrenovic_bureacracy_value = {
	value = 0
	if = {
		limit = {
			has_law = law_type:law_hereditary_bureaucrats
		}
		add = 2
	}
	else_if = {
		limit = {
			has_law = law_type:law_elected_bureaucrats
		}
		subtract = 1
	}
	else = {
		add = 1 # base progress for either side
	}
}

obrenovic_security_value = {
	value = 0
	if = {
		limit = {
			has_law = law_type:law_secret_police
		}
		add = 2
	}
}

obrenovic_land_value = {
	value = 0
	if = {
		limit = {
			has_law = law_type:law_serfdom
		}
		add = 2
	}
	else_if = {
		limit = {
			has_law = law_type:law_tenant_farmers
		}
		add = 1
	}
	else = {
		subtract = 2
	}
}

obrenovic_austria_value = {
	value = 0
	if = {
		limit = {
			c:AUS ?= {
				relations:root >= relations_threshold:amicable
			}
		}
		add = 2
	}
	else_if = {
		limit = {
			c:AUS ?= {
				relations:root = relations_threshold:cordial
			}
		}
		add = 1
	}
	else_if = {
		limit = {
			c:AUS ?= {
				relations:root = relations_threshold:poor
			}
		}
		subtract = 1
	}
	else_if = {
		limit = {
			c:AUS ?= {
				relations:root <= relations_threshold:cold
			}
		}
		subtract = 2
	}
}


obrenovic_progress_value = {
	value = 0
	add = var:obrenovic_power_var
	add = var:obrenovic_bureacracy_var
	add = var:obrenovic_security_var
	add = var:obrenovic_land_var
	add = var:obrenovic_austria_var
}

karadordevic_power_value = {
	value = 0
	if = {
		limit = {
			OR = {
				has_law = law_type:law_census_voting
				has_law = law_type:law_universal_suffrage
			}
		}
		add = 2
	}
	else_if = {
		limit = {
			OR = {
				has_law = law_type:law_landed_voting
				has_law = law_type:law_wealth_voting
			}
		}
		add = 1
	}
	else = {
		subtract = 2
	}
}

karadordevic_bureaucracy_value = {
	value = 0
	if = {
		limit = {
			has_law = law_type:law_hereditary_bureaucrats
		}
		subtract = 2
	}
	else_if = {
		limit = {
			has_law = law_type:law_appointed_bureaucrats
		}
		add = 1
	}
	else = {
		add = 2
	}
}

karadordevic_security_value = {
	value = 0
	if = {
		limit = {
			has_law = law_type:law_guaranteed_liberties
		}
		add = 2
	}
}

karadordevic_land_value = {
	value = 0
	if = {
		limit = {
			has_law = law_type:law_serfdom
		}
		subtract = 2
	}
	else_if = {
		limit = {
			has_law = law_type:law_tenant_farmers
		}
		subtract = 1
	}
	else = {
		add = 2
	}
}

karadordevic_russia_value = {
	value = 0
	if = {
		limit = {
			c:RUS ?= {
				relations:root >= relations_threshold:amicable
			}
		}
		add = 2
	}
	else_if = {
		limit = {
			c:RUS ?= {
				relations:root = relations_threshold:cordial
			}
		}
		add = 1
	}
	else_if = {
		limit = {
			c:RUS ?= {
				relations:root = relations_threshold:poor
			}
		}
		subtract = 1
	}
	else_if = {
		limit = {
			c:RUS ?= {
				relations:root <= relations_threshold:cold
			}
		}
		subtract = 2
	}
}

karadordevic_conquest_value = {
	value = 0
	if = {
		limit = {
			NOT = {
				owns_entire_state_region = STATE_SOUTHERN_SERBIA
			}
			has_variable = balkfm_kaykay_var
		}
		subtract = 2 # Alexander Karadordevic lost a huge chunk of his support for failing to secure Serbian gains after the Crimean War, this should hobble the karadordevic_progress_value until he gets the boot
	}
	else_if = {
		limit = {
			owns_entire_state_region = STATE_SOUTHERN_SERBIA
			has_variable = balkfm_kaykay_var
		}
		add = 2
	}
}

karadordevic_progress_value = {
	value = 0
	add = var:karadordevic_power_var
	add = var:karadordevic_bureaucracy_var
	add = var:karadordevic_security_var
	add = var:karadordevic_land_var
	add = var:karadordevic_russia_var
	add = var:karadordevic_conquest_var
}

## BULGARIA VALUES ##

balkfm_battenburg_support_value = {
# Generally, it should be hard to get this above 5 while retaining liberal laws
	value = 0
	
	# Russia relations check
	if = {
		limit = {
			c:RUS = {
				relations:root > relations_threshold:neutral
			}
		}
		add = {
			value = 1
			desc = balkfm_bul_from_good_russian_relations
		}
	}
	else_if = {
		limit = {
			c:RUS = {
				relations:root < relations_threshold:neutral
			}
		}
		subtract = {
			value = 1
			desc = balkfm_bul_from_bad_russian_relations
		}
	}
	if = {
		limit = {
			has_modifier = modifier_balkfm_russian_attaches
		}
		add = {
			value = 1
			desc = balkfm_bul_from_russian_attaches
		}
	}
	
	# Landowners power check
	if = { 
		limit = {
			AND = {
				ig:ig_landowners = {
					is_powerful = yes
					is_in_government = yes
				}
			}
		}
		add = {
			value = 1
			desc = balkfm_bul_from_powerful_landowners_in_gov
		}
	}
	
	# Military power check
	if = {
		limit = {
			AND = {
				ig:ig_armed_forces = {
					is_powerful = yes
					is_in_government = no
				}
			}
		}
		subtract = {
			value = 1
			desc = balkfm_bul_from_powerful_military_not_in_gov
		}
	}
	
	# Freedom of the press check (balkfm.501)
	if = {
		limit = {
			OR = {
				has_law = law_type:law_protected_speech
				has_law = law_type:law_right_of_assembly
			}
		}
		add = {
			value = 1
			desc = balkfm_bul_from_good_speech_laws
		}
	}
	else_if = {
		limit = {
			OR = {
				has_law = law_type:law_censorship
				has_law = law_type:law_outlawed_dissent
			}
		}
		subtract = {
			value = 1
			desc = balkfm_bul_from_bad_speech_laws
		}
	}
	
	# Autocracy check (balkfm.502)
	if = {
		limit = {
			OR = {
				has_law = law_type:law_autocracy
				has_law = law_type:law_oligarchy
			}
		}
		subtract = {
			value = 1
			desc = balkfm_bul_from_no_voting
		}
	}
	
	# Brigandage check (balkfm.510/511)
	if = {
		limit = {
			has_variable = balkfm_brigandage_completed
		}
		add = {
			value = 1
			desc = balkfm_bul_from_brigandage_completed
		}
	}
	
	# Railways check (balkfm.512/513/514)
	if = {
		limit = {
			has_variable = balkfm_railways_built
		}
		add = 1
	}
	if = {
		limit = {
			has_modifier = modifier_balkfm_railway_buyout
		}
		subtract = {
			value = 1
			desc = balkfm_bul_from_railways_buyout
		}
	}
	
	# Rumelia check (balkfm.581)
	if = {
		limit = {
			AND = {
				owns_entire_state_region = STATE_BULGARIA
				owns_entire_state_region = STATE_NORTHERN_THRACE
			}
		}
		subtract = {
			value = 1
			desc = balkfm_bul_from_controlling_rumelia
		}
	}
	
	# Schism check (balkfm.560)
	if = {
		limit = {
			OR = {
				has_variable = eocfm_schism_var
				has_variable = eocfm_is_autocephalous
			}
		}
		add = {
			value = 1
			desc = balkfm_bul_from_autocephaly
		}
	}
	
	round = 1
	min = 0
	max = 10
	
}

balkfm_stambolovism_value = {
	value = 0
	
	## Sources
	if = {
		limit = {
			exists = heir
		}
		add = {
			value = 1
			desc = balkfm_bul_from_having_heir
		}
	}
	if = {
		limit = {
			ruler = {
				popularity > 50
			}
		}
		add = {
			value = 1
			desc = balkfm_bul_from_ruler_popularity
		}
	}
	if = {
		limit = {
			any_scope_character = {
				has_template = template_balkfm_stambolov_stefan
			}
		}
		add = {
			value = 1
			desc = balkfm_bul_from_stambolov
		}
	}
	if = {
		limit = {
			has_variable = balkfm_battenburg_letter
		}
		add = {
			value = 1
			desc = balkfm_bul_from_battenburg_letter
		}
	}
	if = {
		limit = {
			has_variable = balkfm_military_modernized
		}
		add = {
			value = 1
			desc = balkfm_bul_from_military_modernized
		}
	}
	if = {
		limit = {
			has_variable = balkfm_executed_panitsa
		}
		add = {
			value = 1
			desc = balkfm_bul_from_firing_squad
		}
	}
	if = {
		limit = {
			has_variable = balkfm_showed_off_regalia
		}
		add = {
			value = 1
			desc = balkfm_bul_from_boldness
		}
	}
	
	## Penalities
	
	if = {
		limit = {
			has_variable = balkfm_exiled_panitsa
		}
		subtract = {
			value = 1
			desc = balkfm_bul_from_exiled_panitsa
		}
	}
	if = {
		limit = {
			has_variable = balkfm_put_away_regalia
		}
		subtract = {
			value = 2
			desc = balkfm_bul_from_whimpy
		}
	}
	
	max = 5
	min = 0
	
}

balkfm_revivalism_progress_value = {
	value = 0
	add = {
		value = root.literacy_rate
		desc = balkfm_from_literacy
	}
	add = {
		value = balkfm_intelligentsia_influence_value
		desc = balkfm_bul_from_intelligentsia_influence
	}
	if = {
		limit = {
			has_variable = eocfm_is_autocephalous
		}
		add = {
			value = 10
			desc = balkfm_bul_from_autocephaly
		}
	}
	round = 0.01
}

balkfm_schism_progress_value = {
	value = 0
	add = {
		value = balkfm_intelligentsia_devout_value
		desc = balkfm_bul_from_devout_influence
	}
	add = {
		value = balkfm_ottoman_relations_value
		desc = balkfm_bul_from_ottoman_relations
	}
	round = 0.01
}

balkfm_intelligentsia_influence_value = {
	value = 0
	add = root.prestige
	multiply = root.ig:ig_intelligentsia.ig_clout
}

balkfm_intelligentsia_devout_value = {
	value = 0
	add = root.prestige
	multiply = root.ig:ig_devout.ig_clout
}

balkfm_ottoman_relations_value = {
	value = 0
	c:TUR = {
		add = {
			value = relations:root	
		}
	}
	multiply = 0.1
}

## ROMANIA VALUES ##

# 1848 Variables
balkfm_1848_ruler_popularity_value = {
	value = 0
	add = root.ruler.popularity
	divide = 10
}

balkfm_1848_intelligentsia_approval_value = {
	value = 0
	add = root.ig:ig_intelligentsia.ig_approval
	divide = 10
}

balkfm_1848_landowners_approval_value = {
	value = 0
	add = root.ig:ig_landowners.ig_approval
	divide = 10
}

balkfm_1848_bourgeoisie_approval_value = {
	value = 0
	add = root.ig:ig_petty_bourgeoisie.ig_approval
	divide = 10
}

balkfm_1848_occupation_value = {
	value = 0
	if = {
		limit = {
			has_modifier = modifier_balkfm_russian_occupation
		}
		add = 20
	}
}

balkfm_1848_progress_value = {
	value = 0
	add = var:balkfm_1848_ruler_popularity_var
	add = var:balkfm_1848_intelligentsia_approval_var
	add = var:balkfm_1848_landowners_approval_var
	add = var:balkfm_1848_bourgeoisie_approval_var
	add = var:balkfm_1848_occupation_var
}

# Dezvoltator Values

balkfm_landowners_support_value = {
	value = 0
	add = root.ig:ig_landowners.ig_approval
	multiply = root.ig:ig_landowners.ig_clout
}

balkfm_devout_support_value = {
	value = 0
	add = root.ig:ig_devout.ig_approval
	multiply = root.ig:ig_landowners.ig_clout
}

balkfm_armed_forces_support_value = {
	value = 0
	add = root.ig:ig_armed_forces.ig_approval
	multiply = root.ig:ig_armed_forces.ig_clout
}

balkfm_intelligentsia_support_value = {
	value = 0
	add = root.ig:ig_intelligentsia.ig_approval
	multiply = root.ig:ig_intelligentsia.ig_clout
}

balkfm_industrialists_support_value = {
	value = 0
	add = root.ig:ig_industrialists.ig_approval
	multiply = root.ig:ig_industrialists.ig_clout
}

balkfm_bourgeoisie_support_value = {
	value = 0
	add = root.ig:ig_petty_bourgeoisie.ig_approval
	multiply = root.ig:ig_petty_bourgeoisie.ig_clout
}

balkfm_rural_folk_support_value = {
	value = 0
	add = root.ig:ig_rural_folk.ig_approval
	multiply = root.ig:ig_rural_folk.ig_clout
}

balkfm_trade_unions_support_value = {
	value = 0
	add = root.ig:ig_trade_unions.ig_approval
	multiply = root.ig:ig_trade_unions.ig_clout
}

balkfm_dezvoltator_progress_value = {
	value = 0
	add = var:balkfm_landowners_support_var
	add = var:balkfm_devout_support_var
	add = var:balkfm_armed_forces_support_var
	add = var:balkfm_intelligentsia_support_var
	add = var:balkfm_industrialists_support_var
	add = var:balkfm_bourgeoisie_support_var
	add = var:balkfm_rural_folk_support_var
	add = var:balkfm_trade_unions_support_var
	if = {
		limit = {
			NOT = {
				has_law = law_type:law_autocracy
			}
		}
		multiply = 0.5
	}
}

# 1866 Values

balkfm_1866_ruler_value = {
	value = 0
	add = root.ruler.popularity
	divide = 10
}

balkfm_1866_support_value = {
	value = 0
	every_interest_group = {
		limit = {
			OR = {
				law_stance = {
					law = law_type:law_oligarchy
					value < neutral
				}
				law_stance = {
					law = law_type:law_autocracy
					value < neutral
				}
			}
		}
		add = ig_clout
	}
}

balkfm_1866_progress_value = {
	value = 0
	add = var:balkfm_1866_ruler_var
	add = var:balkfm_1866_support_var
	subtract = var:balkfm_1866_radicals_var
	round = 0.01
}

# Nationalism Values

balkfm_junimism_popularity_value = {
	value = 0
	every_scope_character = {
		limit = {
			OR = {
				law_stance = {
					law = law_type:law_traditionalism
					value > neutral
				}
				law_stance = {
					law = law_type:law_agrarianism
					value > neutral
				}
			}
			AND = {
				has_role = politician
				is_ruler = no
			}
		}
		add = popularity
	}
	divide = 10
}

balkfm_junimism_support_value = {
	value = 0
	if = {
		limit = {
			has_variable = balkfm_supporting_junimism
		}
		add = 1
	}
}

balkfm_junimism_progress_value = {
	value = 0
	add = var:balkfm_junimism_popularity_var
	add = var:balkfm_junimism_landowners_var
	add = var:balkfm_junimism_support_var
}

balkfm_dacianism_popularity_value = {
	value = 0
	every_scope_character = {
		limit = {
			OR = {
				law_stance = {
					law = law_type:law_traditionalism
					value < neutral
				}
				law_stance = {
					law = law_type:law_agrarianism
					value < neutral
				}
			}
			AND = {
				has_role = politician
				is_ruler = no
			}
		}
		add = popularity
	}
	divide = 10
}

balkfm_dacianism_support_value = {
	value = 0
	if = {
		limit = {
			has_variable = balkfm_supporting_dacianism
		}
		add = 1
	}
}

balkfm_dacianism_progress_value = {
	value = 0
	add = var:balkfm_dacianism_popularity_var
	add = var:balkfm_dacianism_intelligentsia_var
	add = var:balkfm_dacianism_support_var
}

balkfm_junimism_lead_value = {
	value = 0
	add = var:balkfm_junimism_progress_var
	subtract = var:balkfm_dacianism_progress_var
}

balkfm_dacianism_lead_value = {
	value = 0
	add = var:balkfm_dacianism_progress_var
	subtract = var:balkfm_junimism_progress_var
}

