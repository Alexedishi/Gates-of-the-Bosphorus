# BALKAN WARS BUTTONS

# YUGOSLAVIA BUTTONS
balkfm_form_yugoslavia_button = {
	name = "balkfm_form_yugoslavia"
	desc = "balkfm_form_yugoslavia_desc"
	
	visible = {
		NOR = {
			has_global_variable = has_formed_yug
			c:SRPS ?= this
			c:TSAR ?= this
			c:TRIU ?= this
			c:BYZ ?= this
		}
	}
	
	possible = { 
	# This are the vanilla requirements to form YUG, just retooled as a button
	# BUL players: if this aligns poorly with previous Bulgarian conquests, remember: you're the one pulling a texas left into Yugoslavism
		is_subject = no
		custom_tooltip = {
			text = balkfm_form_yug_tt
			hidden_trigger = {
				has_variable = balkfm_yugoslav_leader_var
			}
		}
		calc_true_if = {
			amount >= 8
			owns_entire_state_region = STATE_NORTHERN_SERBIA
			owns_entire_state_region = STATE_SOUTHERN_SERBIA
			owns_entire_state_region = STATE_MONTENEGRO
			owns_entire_state_region = STATE_BOSNIA
			owns_entire_state_region = STATE_CROATIA
			owns_entire_state_region = STATE_DALMATIA
			owns_entire_state_region = STATE_SLAVONIA
			owns_entire_state_region = STATE_SLOVENIA
			owns_entire_state_region = STATE_ISTRIA
			owns_entire_state_region = STATE_BANAT
			owns_entire_state_region = STATE_DELVIDEK
		}
	}
	
	effect = {
		change_tag = YUG
		set_global_variable = has_formed_yug
	}
	
}

balkfm_austrian_agitation_button = {
	name = "balkfm_austrian_agitation"
	desc = "balkfm_austrian_agitation_desc"
	
	visible = {
		c:AUS ?= {
			any_scope_state = {
				state_region = {
					OR = {
						is_homeland = cu:serb
						is_homeland = cu:croat
						is_homeland = cu:bosniak
						is_homeland = cu:slovene
						is_homeland = cu:bulgarian
					}
				}
			}
		}
	}
	
	possible = {
		NOT = {
			has_modifier = modifier_balkfm_nationalist_agitation
		}
	}
	
	effect = {
		add_modifier = {
			name = modifier_balkfm_nationalist_agitation
			months = 37
		}
		set_variable = balkfm_yugoslav_agitation_var
		c:AUS ?= {
			trigger_event = {
				id = balkfm.205 # Yugoslavist Agitation in Austria
			}
		}
	}
}

balkfm_ottoman_agitation_button = {
	name = "balkfm_ottoman_agitation"
	desc = "balkfm_ottoman_agitation_desc"
	
	visible = {
		c:TUR ?= {
			any_scope_state = {
				state_region = {
					OR = {
						is_homeland = cu:serb
						is_homeland = cu:croat
						is_homeland = cu:bosniak
						is_homeland = cu:slovene
						is_homeland = cu:bulgarian
					}
				}
			}
		}
	}
	
	possible = {
		NOT = {
			has_modifier = modifier_balkfm_nationalist_agitation
		}
	}
	
	effect = {
		add_modifier = {
			name = modifier_balkfm_nationalist_agitation
			months = 37
		}
		c:TUR ?= {
			trigger_event = {
				id = balkfm.206 # Yugoslavist Agitation in Rumelia
			}
		}
	}
}

# MONTENEGRO BUTTONS
balkfm_compose_epic_button = {
	name = "balkfm_compose_epic"
	desc = "balkfm_compose_epic_desc"
	
	visible = {
		always = yes
	}
	
	possible = {
		NOT = { has_modifier = modifier_balkfm_composing_epic }
	}
	
	effect = {
		set_variable = {
			name = balkfm_epic_composition_var
			value = 0
		}
		add_journal_entry = {
			type = je_balkfm_mon_epic
		}
		add_modifier = modifier_balkfm_composing_epic
	}
}

# SERBIA BUTTONS
balkfm_cement_monarchy_button = {
	name = "balkfm_cement_monarchy"
	desc = "balkfm_cement_monarchy_desc"

	visible = {
		NOR = {
			has_variable = balkfm_pouring_cement_var
			has_variable = balkfm_ser_cement_poured
		}
	}
	
	possible = {
		custom_tooltip = {
			text = balkfm_cement_monarchy_tt1
			hidden_trigger = {
				var:ser_leading_dynasty_var >= 500
			}
		}
		custom_tooltip = {
			text = balkfm_cement_monarchy_tt2
			hidden_trigger = {
				NOT = {
					has_variable = balkfm_constitution_pending
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = balkfm_cement_monarchy_tt3
			hidden_effect = {
				set_variable = {
					name = balkfm_pouring_cement_var
					value = 0
				}
			}
		}
		trigger_event = {
			id = balkfm.420 # Cementing the Monarchy
		}
	}
}

balkfm_restore_serbia_button = {
	name = "balkfm_restore_serbia"
	desc = "balkfm_restore_serbia_desc"
	
	visible = {
		NOT = { has_global_variable = has_formed_srps }
		NOT = { c:YUG ?= this }
	}
	
	possible = {
		custom_tooltip = {
			text = je_balkfm_ser_monarchism_tt
			hidden_trigger = {
				has_variable = balkfm_ser_cement_poured
			}
		}
		owns_entire_state_region = STATE_NORTHERN_SERBIA
		owns_entire_state_region = STATE_SOUTHERN_SERBIA
		owns_entire_state_region = STATE_SKOPIA
		owns_entire_state_region = STATE_MONTENEGRO
		owns_entire_state_region = STATE_BOSNIA
		owns_entire_state_region = STATE_DALMATIA
		owns_entire_state_region = STATE_SLAVONIA
		owns_entire_state_region = STATE_BANAT
		owns_entire_state_region = STATE_DELVIDEK
	}
	
	effect = {
		change_tag = SRPS
		set_global_variable = has_formed_srps
	}

}

# BULGARIA BUTTONS

balkfm_purchase_rail_button = {
	name = "balkfm_purchase_rail"
	desc = "balkfm_purchase_rail_desc"
	
	visible = {
		NOT = { has_variable = balkfm_bought_out_rail }
	}
		
	possible = {
		has_technology_researched = railways
	}
	
	effect = {
		trigger_event = {
			id = balkfm.513 # Extortionate Pricing
		}
		custom_tooltip = balkfm_countercoup_reduce_1
		set_variable = balkfm_bought_out_rail
	}
}

balkfm_annex_rumelia_button = {
	name = "balkfm_annex_rumelia"
	desc = "balkfm_annex_rumelia_desc"
	
	visible = {
		NOT = { has_variable = balkfm_annex_rumelia_taken }
		OR = {
			AND = {
				is_subject_of = c:TUR
				c:ERUM ?= {
					is_ai = yes
					is_subject_of = c:TUR
				}
			}
			AND = {
				is_subject = no
				c:ERUM ?= {
					is_ai = yes
					is_subject = no
				}
			}
		}
	}
	
	possible = {
        custom_tooltip = {
            text = je_unite_the_principalities_friend_with_all_great_powers_tt
			hidden_trigger = {
				any_country = {
					country_rank >= rank_value:great_power
					NOT = { has_war_with = ROOT }
					has_interest_marker_in_region = ROOT.capital.region
					relations:root > 0
				}
			}
        }
		c:ERUM ?= {
			relations:root >= relations_threshold:amicable
			owns_entire_state_region = STATE_NORTHERN_THRACE
			top_overlord = {
				THIS = root.top_overlord
			}
		}
		top_overlord = {
			relations:root <= relations_threshold:neutral
		}
	}
	
	effect = {
		trigger_event = {
			id = balkfm.581 # Union with East Rumelia
		}
		custom_tooltip = balkfm_countercoup_reduce_1
		set_variable = balkfm_annex_rumelia_taken
	}
}

balkfm_declare_tsardom_button = {
	name = "balkfm_declare_tsardom"
	desc = "balkfm_declare_tsardom_desc"
	
	visible = {
		NOT = { has_variable = balkfm_tsardom_declared }
		is_subject = yes
		exists = c:ERUM
	}
		
	possible = {
		NOT = {
			has_journal_entry = je_balkfm_bul_battenburg_monarchy
		}
		owns_entire_state_region = STATE_BULGARIA
		c:ERUM = {
			is_subject_of = root
		}
	}
	
	effect = {
		trigger_event = {
			id = balkfm.582 # An Independent Bulgaria
		}
		custom_tooltip = balkfm_declare_tsardom_tt
		set_variable = balkfm_tsardom_declared
	}
}

balkfm_proclaim_triune_button = {
	name = "balkfm_proclaim_triune"
	desc = "balkfm_proclaim_triune_desc"
	
	visible = {
		NOT = { c:YUG ?= this }
	}
	
	possible = {
		is_subject = no
		owns_entire_state_region = STATE_SLOVENIA
		owns_entire_state_region = STATE_SLAVONIA
		owns_entire_state_region = STATE_CROATIA
		owns_entire_state_region = STATE_DALMATIA	
	}
	
	effect = {
		change_tag = TRIU
		set_global_variable = has_formed_triu
	}
}