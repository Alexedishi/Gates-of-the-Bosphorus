###################
# THE BAVAROCRACY #
###################
je_grefm_bavarocracy_main = { # main entry
	icon = "gfx/interface/icons/event_icons/event_otto.dds"
	
	should_be_pinned_by_default = yes	
	
	complete = {
		has_law = law_type:law_monarchy
		custom_tooltip = {
			text = je_grefm_bavarocracy_tt1
			hidden_trigger = {
				has_variable = grefm_constitution_completed
			}
		}
		custom_tooltip = {
			text = je_grefm_bavarocracy_tt2
			hidden_trigger = {
				has_variable = grefm_land_reform_completed
			}
		}
		custom_tooltip = {
			text = je_grefm_bavarocracy_tt3
			hidden_trigger = {
				has_variable = grefm_brigandage_completed
			}
		}
		custom_tooltip = {
			text = je_grefm_bavarocracy_tt4
			hidden_trigger = {
				has_variable = grefm_civic_tradition_completed
			}
		}
	}
	
	on_complete = {
		trigger_event = {
			id = grefm.007 # mandate secured
		}
	}
		
	fail = {
		NOT = {
			has_law = law_type:law_monarchy 
		}
	}
	
	on_fail = {
		hidden_effect = {
			trigger_event = {
				id = grefm.005 # 404 monarch not found
			}
		}
	}
	
	invalid = {
		custom_tooltip = {
			text = je_grefm_bavarocracy_completed_tt
			hidden_trigger = {
				has_variable = grefm_bavarocracy_completed
			}
		}
	}
	
	on_invalid = {
		hidden_effect = {
			clean_up_bavarocracy_modifiers = yes
			clean_up_bavarocracy_reform_modifiers = yes
		}
	}
	

	status_desc = {
		first_valid = {
			triggered_desc = {
				desc = je_grefm_bavarocracy_main_status
			}
		}
	}

	timeout = 10151 # should cause a revolution in October 1863, still, you got hella time... irl, Otto got to shit the bed for a while anyways
	
	on_timeout = { 
		trigger_event = {
			id = grefm.006 # revolution of 1862
			popup = yes
		}
	}

	modifiers_while_active = {
		modifier_grefm_bavarocracy
	}

	weight = 1000

	transferable = no
}
	
je_grefm_greek_constitution = {
	icon = "gfx/interface/icons/event_icons/event_portrait.dds"
	
	should_be_pinned_by_default = yes
	
	complete = {
		has_law = law_type:law_monarchy
		OR = {
			AND = {
				OR = {
					has_law = law_type:law_appointed_bureaucrats
					has_law = law_type:law_elected_bureaucrats
				}
				OR = {
					has_law = law_type:law_census_voting
					has_law = law_type:law_universal_suffrage
				}
			}
			AND = {
				has_law = law_type:law_monarchy
				has_law = law_type:law_hereditary_bureaucrats
				has_law = law_type:law_autocracy
			}
		}
	}
	
	on_complete = {
		custom_tooltip = {
			text = je_grefm_greek_constitution_tt
			hidden_effect = {
				if = {
					limit = {
						has_law = law_type:law_autocracy
					}
					trigger_event = {
						id = grefm.004 # lol you really thought that INCREASING autocracy was the solution?
					}
				}
				else_if = {
					limit = {
						OR = {
							has_law = law_type:law_census_voting
							has_law = law_type:law_universal_suffrage
						}
					}
					trigger_event= {
						id =  grefm.002 # nice, the revolution was averted
					}
				}
			}
		}
	}
			
	
	timeout = 2801 # haha, this is totally not enough time, but not like Otto was even trying IRL
	
	on_timeout = {
		hidden_effect = {
			trigger_event = {
				id = grefm.003 # its constitution time
				popup = yes
			}
		}
	}

	invalid = {
		NOT = {
			has_law = law_type:law_monarchy 
		}
	}

	weight = 100
	
	transferable = no
}


je_grefm_land_reform = {
	icon = "gfx/interface/icons/event_icons/event_scales.dds"
	
	complete = {
		OR = {
			has_law = law_type:law_homesteading
			has_law = law_type:law_commercialized_agriculture
		}
		OR = {
			has_law = law_type:law_per_capita_based_taxation
			has_law = law_type:law_proportional_taxation
			has_law = law_type:law_graduated_taxation
		}
	}
	
	on_complete = {
		trigger_event = {
			id = grefm.012
		}
	}
	
	invalid = {
		custom_tooltip = {
			text = je_grefm_bavarocracy_completed_tt
			hidden_trigger = {
				has_variable = grefm_bavarocracy_completed
			}
		}
	}

	weight = 100
	
	transferable = no
}

je_grefm_brigandage = {
	icon = "gfx/interface/icons/event_icons/event_fire.dds"
	
	complete = {
		has_law = law_type:law_dedicated_police
		OR = {
			institution_investment_level = {
				institution = institution_police
				value >= 3
			}
			NOT = {
				any_scope_state = {
					turmoil > 0.20
				}
			}
		}
	}
	
	on_complete = {
		trigger_event = {
			id = grefm.014
		}
	}
	
	on_monthly_pulse = {
		random_events = {
			100 = 0
			5 = grefm.030 # the brigands raid again
		}
		effect = {
			if = {
				limit = {
					has_variable =  grefm_the_brigands_raided_again
				}
				change_variable = {
					name = grefm_the_brigands_raided_again
					add = -1
				}
				clamp_variable = { # just to avoid outlandish values
					name = grefm_the_brigands_raided_again
					max = 48 
					min = 0 
				}
			}
		}
	}
	
	invalid = {
		custom_tooltip = {
			text = je_grefm_bavarocracy_completed_tt
			hidden_trigger = {
				has_variable = grefm_bavarocracy_completed
			}
		}
	}
	
	weight = 100
	
	transferable = no	
}

je_grefm_civic_tradition = {
	icon = "gfx/interface/icons/event_icons/event_election.dds"
	
	complete = {
		has_law = law_type:law_elected_bureaucrats
		bureaucracy >= 0 
		approaching_bureaucracy_shortage = no
	}
		
	on_complete = {
		trigger_event = {
			id = grefm.016
		}
	}
	
	invalid = {
		custom_tooltip = {
			text = je_grefm_bavarocracy_completed_tt
			hidden_trigger = {
				has_variable = grefm_bavarocracy_completed
			}
		}
	}
	
	weight = 100
	
	transferable = no
}

je_grefm_the_tyranny_of_house_wittelsbach = { # some alt history nonsense
	icon = "gfx/interface/icons/event_icons/event_otto.dds"
	
	should_be_pinned_by_default = yes	

	on_monthly_pulse = {
		effect = {
			if = {
				limit = {
					has_law = law_type:law_monarchy
					has_law = law_type:law_hereditary_bureaucrats
					has_law = law_type:law_autocracy
					has_law = law_type:law_state_religion		
					has_law = law_type:law_tenant_farmers
					NOT = {
						any_civil_war = {
							civil_war_progress > 0.5
							is_civil_war_type = revolution
						}
					}
					NOT = {
						any_interest_group = {
							law_stance = {
								law = law_type:law_monarchy
								value < neutral
							}
							is_in_government = yes
						}
					}
				}
				change_variable = {
					name = grefm_tyranny_var
					add = 1
				}
			}
		}
	}

	complete = {
		scope:journal_entry = {
			is_goal_complete = yes
		}
		has_law = law_type:law_monarchy
		has_law = law_type:law_hereditary_bureaucrats
		has_law = law_type:law_autocracy
		has_law = law_type:law_state_religion		
		has_law = law_type:law_tenant_farmers
	}
	
	on_complete = {
		trigger_event = {
			id = grefm.007 # mandate secured
		}
	}

	
	timeout = 2800 # this isn't supposed to be easier
	
	on_timeout = { 
		trigger_event = {
			id = grefm.008 # revolution of 1862, but more spicy
		}
	}
	
	fail = {
		NOT = {
			has_law = law_type:law_monarchy 
		}
	}
	
	on_fail = {
		hidden_effect = {
			trigger_event = {
				id = grefm.005 # 404 monarch not found
			}
		}
	}

	invalid = {
		custom_tooltip = {
			text = je_grefm_bavarocracy_completed_tt
			hidden_trigger = {
				has_variable = grefm_bavarocracy_completed
			}
		}
	}	
	
	current_value = {
		value = root.var:grefm_tyranny_var
	}

	goal_add_value = {
		add = 60
	}
	
	progressbar = yes

	weight = 1000
	
	transferable = no	
}

###############################
# THE CONSTITUTIONAL MONARCHY #
###############################
# just a placeholder for now



###################
# THE MEGALI IDEA #
###################

je_grefm_megali_idea = {
	icon = "gfx/interface/icons/event_icons/event_portrait.dds"
	
	should_be_pinned_by_default = yes

	immediate = {
	}

	complete = {
		has_law = law_type:law_monarchy
		owns_entire_state_region = STATE_EASTERN_THRACE
		owns_entire_state_region = STATE_ATTICA
		owns_entire_state_region = STATE_THESSALIA
		owns_entire_state_region = STATE_MACEDONIA
		owns_entire_state_region = STATE_SKOPIA
		owns_entire_state_region = STATE_WESTERN_THRACE
		owns_entire_state_region = STATE_NORTHERN_THRACE
		owns_entire_state_region = STATE_HUDAVENDIGAR
		owns_entire_state_region = STATE_AYDIN
		owns_entire_state_region = STATE_WEST_AEGEAN_ISLANDS
		owns_entire_state_region = STATE_EAST_AEGEAN_ISLANDS
		owns_entire_state_region = STATE_ALBANIA
	}

	on_complete = {
		trigger_event = { id = grefm.202 } # option to convert to BYZ or remain as GRE
	}
	
	invalid = {
		NOT = { c:GRE = this }
	}

	weight = 1000
}


################
# OTHER FLAVOR #
################

je_grefm_corinth_canal_survey = {
	icon = "gfx/interface/icons/event_icons/event_map.dds"
	
	should_be_pinned_by_default = yes

	on_monthly_pulse = {
		effect = {
			change_variable = {
				name = grefm_corinth_canal_var
				add = 1
			}
		}
	}

	complete = {
		scope:journal_entry = { is_goal_complete = yes }
	}

	on_complete = {
		remove_modifier = modifier_grefm_corinth_canal_survey
		trigger_event = { id = grefm.301 } # survey complete
	}

	invalid = {
		NOT = {
			owns_entire_state_region = STATE_PELOPONNESE
		}
	}

	on_invalid = {
		remove_modifier = modifier_grefm_corinth_canal_survey
		remove_variable = grefm_corinth_canal_var
	}

	current_value = {
		value = root.var:grefm_corinth_canal_var
	}

	goal_add_value = {
		value = 24
	}

	progressbar = yes

	weight = 100
	
}

#############
# TECHNICAL #
#############
je_grefm_intro = {
	icon = "gfx/interface/icons/event_icons/tutorial_icon.dds"
	
	should_be_pinned_by_default = no
	
	complete = {
		always = yes # thank heavens for the australia flavor mod people, I would've never figured this out on my own I swear I'm dumber than Porphyrios
	}

	on_complete = {
	}
	
	weight = 1
	
}
