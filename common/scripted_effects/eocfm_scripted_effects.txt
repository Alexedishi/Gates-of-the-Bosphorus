eocfm_initialize_patriarchs_relations_effect = {
	set_variable = {
		name = eocfm_rome_relations_var
		value = 0
	}
	set_variable = {
		name = eocfm_constantinople_relations_var
		value = 0
	}
	set_variable = {
		name = eocfm_antioch_relations_var
		value = 0
	}
	set_variable = {
		name = eocfm_jerusalem_relations_var
		value = 0
	}
	set_variable = {
		name = eocfm_alexandria_relations_var
		value = 0
	}
	set_variable = {
		name = eocfm_moscow_relations_var
		value = 0
	}
}

eocfm_initialize_patriarchs_effect = {
	# Constantinople
	create_character = {
		template = template_eocfm_constantinople_patriarch
		first_name = "Georgios"
		last_name = "Fourtouniadis"
		culture = cu:greek
		on_created = {
			place_character_in_void = 180 # 15 year shelf life
		}
	}

	# Antioch
	create_character = {
		template = template_eocfm_antioch_patriarch
		first_name = "Methodius"
		last_name = "Methodius"
		culture = cu:greek
		on_created = {
			place_character_in_void = 180 # 15 year shelf life
		}
	}
	
	# Jerusalem
	create_character = {
		template = template_eocfm_jerusalem_patriarch
		first_name = "Methodius"
		last_name = "Methodius"
		culture = cu:greek
		on_created = {
			place_character_in_void = 180 # 15 year shelf life
		}
	}
	
	# Alexandria
	create_character = {
		template = template_eocfm_alexandria_patriarch
		first_name = "Hierotheus"
		last_name = "Hierotheus"
		culture = cu:greek
		on_created = {
			place_character_in_void = 180 # 15 year shelf life
		}
	}
	
	# Moscow
	create_character = {
		template = template_eocfm_moscow_patriarch
		first_name = "Vasily"
		last_name = "Drozdov"
		culture = cu:russian
		on_created = {
			place_character_in_void = 180 # 15 year shelf life
		}
	}
}

eocfm_update_patriarch_variables_effect = {
	# Local Metropolitan
	ig:ig_devout = {
		leader = {
			save_scope_as = eocfm_devout_leader_scope
		}
	}
	set_variable = {
		name = eocfm_devout_leader_var
		value = scope:eocfm_devout_leader_scope
	}
	
	# Rome
	if = {
		limit = {
			c:PAP ?= {
				has_law = law_type:law_theocracy
			}
		}
		c:PAP ?= {
			ruler = {
				save_scope_as = eocfm_rome_patriarch_scope
			}
		}
	}
	else_if = {
		limit = {
			any_character_in_void = {
				has_template = template_eocfm_rome_patriarch
			}
		}
		random_character_in_void = {
			limit = {
				has_template = template_eocfm_rome_patriarch
			}
			save_scope_as = eocfm_rome_patriarch_scope
		}
	}
	else = {
		eocfm_replace_patriarchs_effect = yes
		random_character_in_void = {
			limit = {
				has_template = template_eocfm_rome_patriarch
			}
			save_scope_as = eocfm_rome_patriarch_scope
		}
	}
	set_variable = {
		name = eocfm_rome_patriarch_var
		value = scope:eocfm_rome_patriarch_scope
	}
	
	# Constantinople
	if = {
		limit = {
			any_character_in_void = {
				has_template = template_eocfm_constantinople_patriarch
			}
		}
		random_character_in_void = {
			limit = {
				has_template = template_eocfm_constantinople_patriarch
			}
			save_scope_as = eocfm_constantinople_patriarch_scope
		}
	}
	else = {
		eocfm_replace_patriarchs_effect = yes
		random_character_in_void = {
			limit = {
				has_template = template_eocfm_constantinople_patriarch
			}
			save_scope_as = eocfm_constantinople_patriarch_scope
		}
	}
	set_variable = {
		name = eocfm_constantinople_patriarch_var
		value = scope:eocfm_constantinople_patriarch_scope
	}

	# Antioch
	if = {
		limit = {
			any_character_in_void = {
				has_template = template_eocfm_antioch_patriarch
			}
		}
		random_character_in_void = {
			limit = {
				has_template = template_eocfm_antioch_patriarch
			}
			save_scope_as = eocfm_antioch_patriarch_scope
		}
	}
	else = {
		eocfm_replace_patriarchs_effect = yes
		random_character_in_void = {
			limit = {
				has_template = template_eocfm_antioch_patriarch
			}
			save_scope_as = eocfm_antioch_patriarch_scope
		}
	}
	set_variable = {
		name = eocfm_antioch_patriarch_var
		value = scope:eocfm_antioch_patriarch_scope
	}

	# Jerusalem
	if = {
		limit = {
			any_character_in_void = {
				has_template = template_eocfm_jerusalem_patriarch
			}
		}
		random_character_in_void = {
			limit = {
				has_template = template_eocfm_jerusalem_patriarch
			}
			save_scope_as = eocfm_jerusalem_patriarch_scope
		}
	}
	else = {
		eocfm_replace_patriarchs_effect = yes
		random_character_in_void = {
			limit = {
				has_template = template_eocfm_jerusalem_patriarch
			}
			save_scope_as = eocfm_jerusalem_patriarch_scope
		}
	}
	set_variable = {
		name = eocfm_jerusalem_patriarch_var
		value = scope:eocfm_jerusalem_patriarch_scope
	}
	
	# Alexandria
	if = {
		limit = {
			any_character_in_void = {
				has_template = template_eocfm_alexandria_patriarch
			}
		}
		random_character_in_void = {
			limit = {
				has_template = template_eocfm_alexandria_patriarch
			}
			save_scope_as = eocfm_alexandria_patriarch_scope
		}
	}
	else = {
		eocfm_replace_patriarchs_effect = yes
		random_character_in_void = {
			limit = {
				has_template = template_eocfm_alexandria_patriarch
			}
			save_scope_as = eocfm_alexandria_patriarch_scope
		}
	}
	set_variable = {
		name = eocfm_alexandria_patriarch_var
		value = scope:eocfm_alexandria_patriarch_scope
	}
	
	# Moscow
	if = {
		limit = {
			any_character_in_void = {
				has_template = template_eocfm_moscow_patriarch
			}
		}
		random_character_in_void = {
			limit = {
				has_template = template_eocfm_moscow_patriarch
			}
			save_scope_as = eocfm_moscow_patriarch_scope
		}
	}
	else = {
		eocfm_replace_patriarchs_effect = yes
		random_character_in_void = {
			limit = {
				has_template = template_eocfm_moscow_patriarch
			}
			save_scope_as = eocfm_moscow_patriarch_scope
		}
	}
	set_variable = {
		name = eocfm_moscow_patriarch_var
		value = scope:eocfm_moscow_patriarch_scope
	}

}

eocfm_replace_patriarchs_effect = {
	# Rome
	if = {
		limit = {
			NOR = {
				c:PAP ?= {
					has_law = law_type:law_theocracy
				}
				any_character_in_void = {
					has_template = template_eocfm_rome_patriarch
				}
			}
		}
		if = {
			limit = {
				any_country = {
					has_variable = eocfm_controls_rome
					country_has_state_religion = rel:orthodox
				}
			}
			random_country = {
				limit = {
					has_variable = eocfm_controls_rome
					country_has_state_religion = rel:orthodox
				}
				create_character = {
					template = template_eocfm_rome_patriarch
					religion = rel:orthodox
					on_created = {
						place_character_in_void = 180 # 15 year shelf life
					}
				}
			}
		}
		else = {
			create_character = {
				template = template_eocfm_rome_patriarch
				culture = cu:south_italian
				religion = rel:catholic
				on_created = {
					place_character_in_void = 180 # 15 year shelf life
				}
			}
		}
	}
	
	# Constantinople
	if = {
		limit = {
			NOT = {
				any_character_in_void = {
					has_template = template_eocfm_constantinople_patriarch
				}
			}
		}
		if = {
			limit = {
				any_country = {
					has_variable = eocfm_controls_constantinople
					country_has_state_religion = rel:orthodox
				}
			}
			random_country = {
				limit = {
					has_variable = eocfm_controls_constantinople
					country_has_state_religion = rel:orthodox
				}
				create_character = {
					template = template_eocfm_constantinople_patriarch
					on_created = {
						place_character_in_void = 180 # 15 year shelf life
					}
				}
			}
		}
		else = {
			create_character = {
				template = template_eocfm_constantinople_patriarch
				culture = cu:greek
				on_created = {
					place_character_in_void = 180 # 15 year shelf life
				}
			}
		}
	}
	
	# Antioch
	if = {
		limit = {
			NOT = {
				any_character_in_void = {
					has_template = template_eocfm_antioch_patriarch
				}
			}
		}
		if = {
			limit = {
				any_country = {
					has_variable = eocfm_controls_antioch
					country_has_state_religion = rel:orthodox
				}
			}
			random_country = {
				limit = {
					has_variable = eocfm_controls_antioch
					country_has_state_religion = rel:orthodox
				}
				create_character = {
					template = template_eocfm_antioch_patriarch
					on_created = {
						place_character_in_void = 180 # 15 year shelf life
					}
				}
			}
		}
		else = {
			create_character = {
				template = template_eocfm_antioch_patriarch
				culture = cu:greek
				on_created = {
					place_character_in_void = 180 # 15 year shelf life
				}
			}
		}
	}
	
	# Jerusalem
	if = {
		limit = {
			NOT = {
				any_character_in_void = {
					has_template = template_eocfm_jerusalem_patriarch
				}
			}
		}
		if = {
			limit = {
				any_country = {
					has_variable = eocfm_controls_jerusalem
					country_has_state_religion = rel:orthodox
				}
			}
			random_country = {
				limit = {
					has_variable = eocfm_controls_jerusalem
					country_has_state_religion = rel:orthodox
				}
				create_character = {
					template = template_eocfm_jerusalem_patriarch
					on_created = {
						place_character_in_void = 180 # 15 year shelf life
					}
				}
			}
		}
		else = {
			create_character = {
				template = template_eocfm_jerusalem_patriarch
				culture = cu:greek
				on_created = {
					place_character_in_void = 180 # 15 year shelf life
				}
			}
		}
	}
	
	# Alexandria
	if = {
		limit = {
			NOT = {
				any_character_in_void = {
					has_template = template_eocfm_alexandria_patriarch
				}
			}
		}
		if = {
			limit = {
				any_country = {
					has_variable = eocfm_controls_alexandria
					country_has_state_religion = rel:orthodox
				}
			}
			random_country = {
				limit = {
					has_variable = eocfm_controls_alexandria
					country_has_state_religion = rel:orthodox
				}
				create_character = {
					template = template_eocfm_alexandria_patriarch
					on_created = {
						place_character_in_void = 180 # 15 year shelf life
					}
				}
			}
		}
		else = {
			create_character = {
				template = template_eocfm_alexandria_patriarch
				culture = cu:greek
				on_created = {
					place_character_in_void = 180 # 15 year shelf life
				}
			}
		}
	}
	
	# Moscow
	if = {
		limit = {
			NOT = {
				any_character_in_void = {
					has_template = template_eocfm_moscow_patriarch
				}
			}
		}
		if = {
			limit = {
				any_country = {
					has_variable = eocfm_controls_moscow
					country_has_state_religion = rel:orthodox
				}
			}
			random_country = {
				limit = {
					has_variable = eocfm_controls_moscow
					country_has_state_religion = rel:orthodox
				}
				create_character = {
					template = template_eocfm_moscow_patriarch
					on_created = {
						place_character_in_void = 180 # 15 year shelf life
					}
				}
			}
		}
		else = {
			create_character = {
				template = template_eocfm_moscow_patriarch
				culture = cu:russian
				on_created = {
					place_character_in_void = 180 # 15 year shelf life
				}
			}
		}
	}
	
}

eocfm_update_seat_controllers_effect = {
	#Rome
	if = {
		limit = {
			any_country = {
				has_variable = eocfm_controls_rome
			}
		}
		random_country = {
			limit = {
				has_variable = eocfm_controls_rome
			}
			save_scope_as = eocfm_rome_controller_scope
		}
		set_variable = {
			name = eocfm_rome_controller_var
			value = scope:eocfm_rome_controller_scope
		}
	}
	else = {
		set_variable = {
			name = eocfm_rome_controller_var
			value = 0
		}
	}

	#Constantinople
	if = {
		limit = {
			any_country = {
				has_variable = eocfm_controls_constantinople
			}
		}
		random_country = {
			limit = {
				has_variable = eocfm_controls_constantinople
			}
			save_scope_as = eocfm_constantinople_controller_scope
		}
		set_variable = {
			name = eocfm_constantinople_controller_var
			value = scope:eocfm_constantinople_controller_scope
		}
	}
	else = {
		set_variable = {
			name = eocfm_constantinople_controller_var
			value = 0
		}
	}
	
	#Antioch
	if = {
		limit = {
			any_country = {
				has_variable = eocfm_controls_antioch
			}
		}
		random_country = {
			limit = {
				has_variable = eocfm_controls_antioch
			}
			save_scope_as = eocfm_antioch_controller_scope
		}
		set_variable = {
			name = eocfm_antioch_controller_var
			value = scope:eocfm_antioch_controller_scope
		}
	}
	else = {
		set_variable = {
			name = eocfm_antioch_controller_var
			value = 0
		}
	}
	
	#Jerusalem
	if = {
		limit = {
			any_country = {
				has_variable = eocfm_controls_jerusalem
			}
		}
		random_country = {
			limit = {
				has_variable = eocfm_controls_jerusalem
			}
			save_scope_as = eocfm_jerusalem_controller_scope
		}
		set_variable = {
			name = eocfm_jerusalem_controller_var
			value = scope:eocfm_jerusalem_controller_scope
		}
	}
	else = {
		set_variable = {
			name = eocfm_jerusalem_controller_var
			value = 0
		}
	}
	
	#Alexandria
	if = {
		limit = {
			any_country = {
				has_variable = eocfm_controls_alexandria
			}
		}
		random_country = {
			limit = {
				has_variable = eocfm_controls_alexandria
			}
			save_scope_as = eocfm_alexandria_controller_scope
		}
		set_variable = {
			name = eocfm_alexandria_controller_var
			value = scope:eocfm_alexandria_controller_scope
		}
	}
	else = {
		set_variable = {
			name = eocfm_alexandria_controller_var
			value = 0
		}
	}
	
	#Moscow
	if = {
		limit = {
			any_country = {
				has_variable = eocfm_controls_moscow
			}
		}
		random_country = {
			limit = {
				has_variable = eocfm_controls_moscow
			}
			save_scope_as = eocfm_moscow_controller_scope
		}
		set_variable = {
			name = eocfm_moscow_controller_var
			value = scope:eocfm_moscow_controller_scope
		}
	}
	else = {
		set_variable = {
			name = eocfm_moscow_controller_var
			value = 0
		}
	}
	
}

eocfm_save_seat_controller_scopes_effect = {
	random_country = {
		limit = {
			has_variable = eocfm_controls_rome
		}
		save_scope_as = eocfm_rome_controller
	}
	random_country = {
		limit = {
			has_variable = eocfm_controls_constantinople
		}
		save_scope_as = eocfm_constantinople_controller
	}
	random_country = {
		limit = {
			has_variable = eocfm_controls_antioch
		}
		save_scope_as = eocfm_antioch_controller
	}
	random_country = {
		limit = {
			has_variable = eocfm_controls_alexandria
		}
		save_scope_as = eocfm_alexandria_controller
	}
	random_country = {
		limit = {
			has_variable = eocfm_controls_jerusalem
		}
		save_scope_as = eocfm_jerusalem_controller
	}
	random_country = {
		limit = {
			has_variable = eocfm_controls_moscow
		}
		save_scope_as = eocfm_moscow_controller
	}
}

eocfm_update_seat_bonus_effect = {
	hidden_effect = {
		remove_modifier ?= modifier_eocfm_controls_rome
		remove_modifier ?= modifier_eocfm_controls_constantinople
		remove_modifier ?= modifier_eocfm_controls_antioch
		remove_modifier ?= modifier_eocfm_controls_alexandria
		remove_modifier ?= modifier_eocfm_controls_jerusalem
		remove_modifier ?= modifier_eocfm_controls_moscow
	}
	if = {
		limit = {
			has_variable = eocfm_controls_rome
			owns_entire_state_region = STATE_LAZIO
		}
		add_modifier = modifier_eocfm_controls_rome
	}
	if = {
		limit = {
			has_variable = eocfm_controls_constantinople
			owns_entire_state_region = STATE_EASTERN_THRACE
		}
		add_modifier = modifier_eocfm_controls_constantinople
	}
	if = {
		limit = {
			has_variable = eocfm_controls_antioch
			owns_entire_state_region = STATE_SYRIA
		}
		add_modifier = modifier_eocfm_controls_antioch
	}
	if = {
		limit = {
			has_variable = eocfm_controls_alexandria
			owns_entire_state_region = STATE_LOWER_EGYPT
		}
		add_modifier = modifier_eocfm_controls_alexandria
	}
	if = {
		limit = {
			has_variable = eocfm_controls_jerusalem
			owns_entire_state_region = STATE_PALESTINE
		}
		add_modifier = modifier_eocfm_controls_jerusalem
	}
	if = {
		limit = {
			has_variable = eocfm_controls_moscow
			owns_entire_state_region = STATE_MOSCOW
		}
		add_modifier = modifier_eocfm_controls_moscow
	}
}

eocfm_update_patriarch_relations_effect = {
	set_variable = {
		name = eocfm_rome_progress_var
		value = eocfm_rome_progress_value
	}
	set_variable = {
		name = eocfm_constantinople_progress_var
		value = eocfm_constantinople_progress_value
	}
	set_variable = {
		name = eocfm_antioch_progress_var
		value = eocfm_antioch_progress_value
	}
	set_variable = {
		name = eocfm_jerusalem_progress_var
		value = eocfm_jerusalem_progress_value
	}
	set_variable = {
		name = eocfm_alexandria_progress_var
		value = eocfm_alexandria_progress_value
	}
	set_variable = {
		name = eocfm_moscow_progress_var
		value = eocfm_moscow_progress_value
	}
}

eocfm_push_patriarch_relations_effect = {
	change_variable = {
		name = eocfm_rome_relations_var
		add = var:eocfm_rome_progress_var
	}
	clamp_variable = {
		name = eocfm_rome_relations_var
		min = 0
		max = 100
	}
	change_variable = {
		name = eocfm_constantinople_relations_var
		add = var:eocfm_constantinople_progress_var
	}
	clamp_variable = {
		name = eocfm_constantinople_relations_var
		min = 0
		max = 100
	}
	change_variable = {
		name = eocfm_antioch_relations_var
		add = var:eocfm_antioch_progress_var
	}
	clamp_variable = {
		name = eocfm_antioch_relations_var
		min = 0
		max = 100
	}
	change_variable = {
		name = eocfm_jerusalem_relations_var
		add = var:eocfm_jerusalem_progress_var
	}
	clamp_variable = {
		name = eocfm_jerusalem_relations_var
		min = 0
		max = 100
	}
	change_variable = {
		name = eocfm_alexandria_relations_var
		add = var:eocfm_alexandria_progress_var
	}
	clamp_variable = {
		name = eocfm_alexandria_relations_var
		min = 0
		max = 100
	}
	change_variable = {
		name = eocfm_moscow_relations_var
		add = var:eocfm_moscow_progress_var
	}
	clamp_variable = {
		name = eocfm_moscow_relations_var
		min = 0
		max = 100
	}
}

eocfm_remove_all_modifiers_effect = {
	remove_modifier ?= modifier_eocfm_hosting_council
	remove_modifier ?= modifier_eocfm_integrating_seat
	remove_modifier ?= modifier_eocfm_reformed_synod
	remove_modifier ?= modifier_eocfm_restored_synod
	remove_modifier ?= modifier_eocfm_asserted_caesaropapism
	remove_modifier ?= modifier_eocfm_subsidizing_church
	remove_modifier ?= modifier_eocfm_sunday_schools
	remove_modifier ?= modifier_eocfm_disbanded_sunday_schools
	remove_modifier ?= modifier_eocfm_dissolved_monasteries
}

eocfm_remove_focus_modifiers_effect = {
	hidden_effect = {
		remove_modifier ?= modifier_eocfm_emphasize_unity
		remove_modifier ?= modifier_eocfm_enforce_attendance
		remove_modifier ?= modifier_eocfm_theologize_dogma
		remove_modifier ?= modifier_eocfm_promote_ecumenism
	}
}

eocfm_remove_icon_modifiers_effect = {
	remove_modifier ?= modifier_eocfm_icon_christ_pantocrator
	remove_modifier ?= modifier_eocfm_icon_eleusa
	remove_modifier ?= modifier_eocfm_icon_john_climacus
	remove_modifier ?= modifier_eocfm_icon_michael_archistrategos
	remove_modifier ?= modifier_eocfm_icon_nikolaos_wonderworker
	remove_modifier ?= modifier_eocfm_icon_gregory_nazianzus
	remove_modifier ?= modifier_eocfm_icon_paul_of_thebes
	remove_modifier ?= modifier_eocfm_icon_issac_the_syrian
	remove_modifier ?= modifier_eocfm_icon_basil_megas
}

eocfm_remove_intregration_variables_effect = {
	remove_variable = eocfm_integration_var
	remove_variable = eocfm_integrating_rome
	remove_variable = eocfm_integrating_constantinople
	remove_variable = eocfm_integrating_antioch
	remove_variable = eocfm_integrating_alexandria
	remove_variable = eocfm_integrating_jerusalem
	remove_variable = eocfm_integrating_moscow
	remove_variable = eocfm_seat_dispute_var
	remove_variable = eocfm_seat_endorsed
	remove_variable = eocfm_seat_opposed
}

eocfm_remove_seat_modifiers_effect = {
	remove_modifier ?= modifier_eocfm_controls_rome
	remove_modifier ?= modifier_eocfm_controls_constantinople
	remove_modifier ?= modifier_eocfm_controls_antioch
	remove_modifier ?= modifier_eocfm_controls_alexandria
	remove_modifier ?= modifier_eocfm_controls_jerusalem
	remove_modifier ?= modifier_eocfm_controls_moscow
}

eocfm_council_cleanup_effect = {
	if = {
		limit = {
			has_modifier = modifier_eocfm_hosting_council
		}
		remove_modifier = modifier_eocfm_hosting_council
		add_modifier = {
			name = modifier_eocfm_hosted_council 
			months = long_modifier_time
		}
	}
}

eocfm_crusade_cleanup_effect = {
	remove_variable = eocfm_crusade_initiator
	remove_variable = eocfm_crusade_target
	remove_variable = eocfm_crusade_attacker
	remove_variable = eocfm_crusade_warmup_var
}
