on_monthly_pulse_country = {
	on_actions = {
		balkfm_monthly_pulse
		mon_flavor_pulse
		ser_flavor_pulse
		bul_flavor_pulse
	}
}

on_wargoal_enforced = {
	on_actions = {
		balkfm_crisis_wargoal_enforced
	}
}


############

balkfm_monthly_pulse = { # These events are persistently monitored
	events = {
		grefm.901 # non-GRE claims
		grefm.903 # removes crete revolt variable
		grefm.904 # revolt preemption
		grefm.910 # EPI customs union
		grefm.911 # epirote revolt
		grefm.912 # cypriot revolt
		grefm.913 # macedonian revolt
		grefm.915 # assigns the revolt JE
		
		balkfm.100 # Creates Crisis DP and Escalates It
	}
}

mon_flavor_pulse = {
	trigger = {
		country_has_primary_culture = cu:serb
		OR = {
			c:MON ?= this
		}
	}
	events = {
		balkfm.332 # Knives in the Dark
		balkfm.337 # The Arrogance of Smail-aga
		balkfm.341 # Osman Pasha Attacks!
	}
	random_events = {
		100 = 0
	}
}

ser_flavor_pulse = {
	trigger = {
		country_has_primary_culture = cu:serb
		OR = {
			c:SER ?= this
		}
	}
	events = {
		balkfm.405 # Disruptive Influence
	}
	random_events = {
		100 = 0
	}
}

bul_flavor_pulse = {
	trigger = {
		country_has_primary_culture = cu:bulgarian
	}
	events = {
	}
	random_events = {
		100 = 0
	}
}		
		
############

#These on_actions are specifically to catch Bulgaria and create it as BUL & ERUM if possible

on_country_released_as_independent = {
	on_actions = {
		balkfm_release_pulse_1
	}
}

on_country_released_as_own_subject = {
	on_actions = {
		balkfm_release_pulse_2
	}
}

balkfm_release_pulse_1 = { # BUL keeps ERUM if fully independent
	effect = {
		if = {
			limit = {
				c:BUL ?= scope:target
				NOT = { has_global_variable = balkfm_lion_awakened }
			}
			scope:target = {
				balkfm_set_bulgarian_laws = yes
				balkfm_create_bulgarian_characters = yes
				trigger_event = {
					id = balkfm.500 # The Golden Lion Awakens
				}
			}
		}
	}
}

balkfm_release_pulse_2 = { # Splits BUL and ERUM if BUL is released as a subject
	effect = {
		if = {
			limit = {
				c:BUL ?= scope:target
				NOT = { has_global_variable = balkfm_lion_awakened }
			}
			scope:target = {
				balkfm_set_bulgarian_laws = yes
				balkfm_create_bulgarian_characters = yes
				trigger_event = {
					id = balkfm.500 # The Golden Lion Awakens
				}
			}
			if = {
				limit = {
					c:TUR = {
						owns_entire_state_region = STATE_NORTHERN_THRACE
					}
				}
				create_country = {
					tag = ERUM
					origin = this
					state = s:STATE_NORTHERN_THRACE.region_state:TUR
					on_created = {
					}
				}
				c:TUR ?= {
					create_diplomatic_pact = {
						country = c:ERUM
						type = puppet
					}
				}
			}
			else_if = {
				limit = {
					c:BUL = {
						owns_entire_state_region = STATE_NORTHERN_THRACE
					}
				}
				create_country = {
					tag = ERUM
					origin = this
					state = s:STATE_NORTHERN_THRACE.region_state:BUL
					on_created = {
					}
				}
				c:TUR ?= {
					create_diplomatic_pact = {
						country = c:ERUM
						type = puppet
					}
				}
			}
		}
	}
}

############

# These on_actions trigger from the victor scope

balkfm_crisis_wargoal_enforced = {
	trigger = {
		has_global_variable = balkfm_crisis_happened
		OR = {
			has_variable = balkfm_crisis_target
			has_variable = balkfm_crisis_starter
		}
	}
	effect = {
		if = {
			limit = {
				has_variable = balkfm_crisis_starter
			}
			every_country = {
				limit = {
					balkfm_crisis_participant_trigger = yes
				}
				trigger_event = {
					id = balkfm.106 # The Treaty of Berlin
				}
			}
			set_global_variable = balkfm_eastern_crisis_resolved
		}
		if = {
			limit = {
				has_variable = balkfm_crisis_target
			}
			c:TUR = {
				trigger_event = {
					id = balkfm.107 # The Porte Triumphant
				}
			}
			set_global_variable = balkfm_eastern_crisis_resolved
		}
	}
}