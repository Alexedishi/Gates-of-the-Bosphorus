on_monthly_pulse_country = {
	on_actions = {
		byfzm_monthly_pulse
		byzfm_chariot_pulse_1
		byzfm_chariot_pulse_2
	}
}

on_wargoal_enforced = {
	on_actions = {
		byzfm_wargoal_enforced
	}
}

byfzm_monthly_pulse = {
	trigger = {
		OR = {
			exists = c:BYZ
			exists = c:ERE
			exists = c:SPQR
			exists = c:HEMP
			exists = c:ODXY
		}
	}
	events = {
		byzfm.100 # Event beginning construction of Imperial Palace
		byzfm.123 # drag racing in the hippodrome
	}
	random_events = {
		100 = 0
	}
	effect = {
		if = {
			limit = {
				has_variable =  byzfm_held_chariot_races
			}
			change_variable = {
				name = byzfm_held_chariot_races
				add = -1
			}
			clamp_variable = { # just to avoid outlandish values
				name = byzfm_held_chariot_races
				max = 48 
				min = 0 
			}
		}
	}
}

byzfm_chariot_pulse_1 = {
	trigger = {
		has_modifier = modifier_byzfm_chariot_racing
		has_variable = byzfm_held_chariot_races
		var:byzfm_held_chariot_races < 1
	}
	random_events = {
		20 = byzfm.110 # reds win
		20 = byzfm.111 # whites win
		20 = byzfm.112 # greens win
		20 = byzfm.113 # blues win
		10 = byzfm.116 # first match complete, crowd calls for diversum
		 1 = byzfm.117 # sporting riot
		 1 = byzfm.118 # ruler tries to join race
		 1 = byzfm.119 # team gets caught cheating
	}
}

byzfm_chariot_pulse_2 = {
	trigger = {
		has_modifier = modifier_byzfm_expanded_chariot_racing
		has_variable = byzfm_held_chariot_races
		var:byzfm_held_chariot_races < 1
	}
	random_events = {
		25 = byzfm.110 # reds win - industrialists
		25 = byzfm.111 # whites win - intel
		25 = byzfm.112 # greens win - rural folk
		25 = byzfm.113 # blues win - petite
		25 = byzfm.114 # purples win - landowners
		25 = byzfm.115 # golds win - trade unions
		15 = byzfm.116 # first match complete, crowd calls for diversum
		 5 = byzfm.117 # sporting riot
		 5 = byzfm.118 # ruler tries to join race
		 1 = byzfm.119 # team gets caught cheating
	}
}

byzfm_wargoal_enforced = {
	trigger = {
		any_country = {
			has_variable = crusade_target
		}
	}
	effect = {
		random_country = {
			limit = {
				has_variable = crusade_target
			}
			save_scope_as = crusade_target
		}
		random_country = {
			limit = {
				has_variable = byzfm_crusades_unlocked
			}
			save_scope_as = crusade_aggressor
		}
		scope:crusade_target = {
			set_state_religion = rel:orthodox
		}
		every_country = {
			limit = {
				has_variable = crusade_target
			}
			remove_variable = crusade_target
		}
	}
}