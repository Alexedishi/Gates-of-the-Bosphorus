on_monthly_pulse_country = {
	on_actions = {
		byfzm_monthly_pulse
		byzfm_chariot_pulse_1
		byzfm_chariot_pulse_2
	}
}

on_yearly_pulse_country = {
	on_actions = {
		byzfm_yearly_pulse
	}
}

on_wargoal_enforced = {
	on_actions = {
		byzfm_wargoal_enforced
	}
}

byfzm_monthly_pulse = {
	trigger = {
		OR = {
			exists = c:BYZ
			exists = c:ERE
			exists = c:SPQR
			exists = c:HEMP
			exists = c:ODXY
		}
	}
	events = {
		byzfm.6  # ERE branching decision
		byzfm.8  # restoration of the patriarchate
		byzfm.9  # notification of the ERE to other countries
		byzfm.19 # hedjaz captured
		byzfm.38 # Greco-Roman relations
		byzfm.40 # Event beginning construction of Imperial Palace
		byzfm.47 # drag racing in the hippodrome
		byzfm.90 # anatolia reclaimed
		byzfm.91 # balkans reclaimed
	}
	random_events = {
		100 = 0
	}
	effect = {
		if = {
			limit = {
				has_variable =  byzfm_held_chariot_races
			}
			change_variable = {
				name = byzfm_held_chariot_races
				add = -1
			}
			clamp_variable = { # just to avoid outlandish values
				name = byzfm_held_chariot_races
				max = 48 
				min = 0 
			}
		}
	}
}

byzfm_yearly_pulse = {
	events = {
#		byzfm.99 # culture check
	}
	random_events = {
		100 = 0
	}
}

byzfm_chariot_pulse_1 = {
	trigger = {
		has_modifier = modifier_byzfm_chariot_racing
		has_variable = byzfm_held_chariot_races
		var:byzfm_held_chariot_races < 1
	}
	random_events = {
		20 = byzfm.50 # reds win
		20 = byzfm.51 # whites win
		20 = byzfm.52 # greens win
		20 = byzfm.53 # blues win
		10 = byzfm.56 # first match complete, crowd calls for diversum
		 1 = byzfm.57 # sporting riot
		 1 = byzfm.58 # ruler tries to join race
		 1 = byzfm.59 # team gets caught cheating
	}
}

byzfm_chariot_pulse_2 = {
	trigger = {
		has_modifier = modifier_byzfm_expanded_chariot_racing
		has_variable = byzfm_held_chariot_races
		var:byzfm_held_chariot_races < 1
	}
	random_events = {
		25 = byzfm.50 # reds win - industrialists
		25 = byzfm.51 # whites win - intel
		25 = byzfm.52 # greens win - rural folk
		25 = byzfm.53 # blues win - petite
		25 = byzfm.54 # purples win - landowners
		25 = byzfm.55 # golds win - trade unions
		15 = byzfm.56 # first match complete, crowd calls for diversum
		 5 = byzfm.57 # sporting riot
		 5 = byzfm.58 # ruler tries to join race
		 1 = byzfm.59 # team gets caught cheating
	}
}

byzfm_wargoal_enforced = {
	trigger = {
		any_country = {
			has_variable = crusade_target
		}
	}
	effect = {
		random_country = {
			limit = {
				has_variable = crusade_target
			}
			save_scope_as = crusade_target
		}
		random_country = {
			limit = {
				has_variable = byzfm_crusades_unlocked
			}
			save_scope_as = crusade_aggressor
		}
		scope:crusade_target = {
			set_state_religion = rel:orthodox
		}
		scope:crusade_aggressor = {
			change_variable = {
				name = byzfm_crusade_counter
				add = 1
			}
		}
		every_country = {
			limit = {
				has_variable = crusade_target
			}
			remove_variable = crusade_target
		}
	}
}